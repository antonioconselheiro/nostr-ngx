<h2 class="title">Relay Manager</h2>
<h3 class="title">Relays are independent nostr servers.</h3>
<h3 class="title">Choose more than one relay makes you cool.</h3>

<form novalidate autocomplete="off">
  <!-- TODO: o usuário deve ser capaz de colar uma lista de relays -->
  <ul *ngIf="relaysFrom !== 'signer'" class="relayList">
    <li *ngFor="let relay of listRelays()" class="connected">
      <a>{{relay.relay}}{{!relay.write ? ' (cache)' : ''}}</a>
      <button (click)="removeRelay(relay.relay)" type="button">✕</button>
    </li>
  </ul>

  <div *ngIf="relaysFrom !== 'signer'" class="floatingLabel">
    <input type="text" #myRelaysNewRelay name="newRelay" id="myRelaysNewRelay" placeholder=" " />
    <label for="myRelaysNewRelay">{{relayWritable ? 'New publishable relay' : 'New readonly relay'}}</label>

    <button type="button" [attr.title]="relayWritable ? 'set as readonly' : 'set as writable'"
      (click)="relayWritable = !relayWritable" class="bordered svgButton">

      <nostr-svg-render [name]="relayWritable ? 'readonly' : 'writable'"></nostr-svg-render>
    </button>

    <button type="button" (click)="connect(myRelaysNewRelay.value); myRelaysNewRelay.value = '';" title="connect" class="bordered svgButton">
      <nostr-svg-render name="plugConnected"></nostr-svg-render>
    </button>
  </div>

  <div class="floatingLabel">
    <select [(ngModel)]="relaysFrom" name="relaysFrom" id="myRelaysRelaysFrom" placeholder=" ">
      <option value="public">Publically</option>
      <option value="localStorage">In browser</option>
      <!-- TODO: analisar qual será o fluxo para quando esta opção é selecionada  -->
      <option value="signer">Signer Extension</option>
    </select>

    <label for="myRelaysRelaysFrom">Save relays</label>
  </div>

  <div>
    <p *ngIf="relaysFrom === 'public'">
      <strong>Publically</strong>: saves your relays inside your choosen relays
    </p>
    <p *ngIf="relaysFrom === 'localStorage'">
      <strong>In browser</strong>: save your relays in this browser
    </p>
    <p *ngIf="relaysFrom === 'signer'">
      <strong>Signer Extension</strong>: don't save relays, use relays from nostr signer extension
    </p>
  </div>

</form>

<footer class="buttonGroup">
  <button (click)="changeStep.next('selectAccount')" type="button" title="cancel"
    class="actionButton button secondary iconedButton">
    <nostr-svg-render class="inlineIcon" name="left"></nostr-svg-render>

    <span>
      Cancel
    </span>
  </button>

  <button type="button" title="search relays"
    class="actionButton button secondary iconedButton">
    <nostr-svg-render class="inlineIcon" name="search"></nostr-svg-render>

    <span>
      Search Relays
    </span>
  </button>
  

  <!--
  TODO: se não houver nenhum relay configurado:
  deve haver um botão "Use default", como primary, ele deve preencher os
  relays com um conjunto de relays definidso como padrão para a aplicação.
  O botão "save" não deve ser exibido

  se houver relays configurados:
  o botão use default deve se tornar secondary e o botão para salvar deve estar como primary ao lado
  -->
  <button (click)="changeStep.next('registerAccount')" type="button" title="save"
    class="actionButton button iconedButton" form="generateNcryptsecForm">
    <nostr-svg-render class="inlineIcon" name="right"></nostr-svg-render>

    <span>
      Save
    </span>
  </button>
</footer>