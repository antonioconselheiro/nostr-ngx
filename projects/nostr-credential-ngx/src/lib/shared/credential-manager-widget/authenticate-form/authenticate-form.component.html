<h2 class="title">Authenticate</h2>
<p>Insert the password to open the Nostr Secret and authenticate</p>

<section *ngIf="account" class="unauthenticated-account">
  <nostr-profile-picture [account]="account"></nostr-profile-picture>
  <div class="user-info">
    <span class="user-name">
      {{account.displayName}}
      <span *ngIf="account.nip05valid" class="user-verified"></span>
    </span>
    <span *ngIf="account.nip05" class="user-nip5">{{account.nip05}}</span>
  </div>
</section>

<form [formGroup]="authenticateForm" (submit)="onAuthenticateSubmit($event)" novalidate autocomplete="off">
  <div [class.error]="showErrors()" class="floatingLabel">
    <input #password name="password" tabindex="1" [maxlength]="passwordLength" formControlName="password" id="authenticatePasswordField"
      [class.hasValue]="password.value" [attr.type]="showPassword ? 'text' : 'password'" />

    <label for="authenticatePasswordField">Password</label>

    <button type="button" tabindex="4" [attr.title]="showPassword ? 'hide password' : 'show password'"
     (click)="showPassword = !showPassword" class="bordered svgButton">
      <nostr-svg-render [name]="showPassword ? 'eyeOff' : 'eye'"></nostr-svg-render>
    </button>

    <ng-container *ngIf="showErrors()">
      <span *ngIf="getFormControlErrorStatus('required')" class="error">Password is required</span>
      <span *ngIf="getFormControlErrorStatus('invalid')" class="error">Invalid password, nsec could not be open</span>
    </ng-container>
  </div>

  <div class="button-group">
    <button type="submit" tabindex="2" title="authenticate" class="action-button button secondary iconedButton">
      <nostr-svg-render *ngIf="!loading" class="inlineIcon" name="unlock"></nostr-svg-render>

      <nostr-loading *ngIf="loading"></nostr-loading>

      <span>
        Authenticate
      </span>
    </button>

    <button (click)="changeStep.next('select-account')" type="button" tabindex="3" title="back"
      class="action-button button secondary iconedButton">
      <nostr-svg-render class="inlineIcon" name="left"></nostr-svg-render>

      <span>
        Back
      </span>
    </button>
  </div>
</form>
