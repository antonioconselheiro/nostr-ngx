<h2 class="title">Login</h2>
<form [formGroup]="accountForm" (submit)="onAddAccountSubmit($event)" novalidate autocomplete="off">
  <div [class.error]="submitted && getFormControlErrors('nostrSecret')" class="floatingLabel">
    <input #nostrSecret required name="nostrSecret" tabindex="11" maxlength="64" formControlName="nostrSecret"
      id="addAccountNsecField" [class.hasValue]="nostrSecret.value" [attr.readonly]="loading ? 'readonly' : null"
      [attr.type]="showNostrSecret ? 'text' : 'password'" />
    <label for="addAccountNsecField">Nostr Secret (nsec)</label>

    <button type="button" tabindex="17" title="read nsec from qrcode" (click)="asyncReadQrcodeUsingCamera()"
      class="bordered svgButton">

      <nostr-svg-render name="scanQrcode"></nostr-svg-render>
    </button>

    <button type="button" tabindex="18" [attr.title]="showNostrSecret ? 'hide nostr secret' : 'show nostr secret'"
      (click)="showNostrSecret = !showNostrSecret" class="bordered svgButton">

      <nostr-svg-render [name]="showNostrSecret ? 'eyeOff' : 'eye'"></nostr-svg-render>
    </button>

    <ng-container *ngIf="submitted">
      <span *ngIf="getFormControlErrorStatus('nostrSecret', 'required')" class="error">
        Nostr Secret cannot be blank
      </span>
      <span *ngIf="getFormControlErrorStatus('nostrSecret', 'invalidNostrPublicGivenInstead')" class="error">
        Nostr Public given instead Nostr Secret
      </span>
      <span *ngIf="getFormControlErrorStatus('nostrSecret', 'invalidNostrSecret')" class="error">
        Invalid Nostr Secret
      </span>
      <span *ngIf="getFormControlErrorStatus('nostrSecret', 'nostrSecretNotFound')" class="error">
        Could not found this account in current relay pool
      </span>
    </ng-container>
  </div>

  <div class="nostrCheckWrapper">
    <input name="saveNcryptsecLocalStorage" formControlName="saveNcryptsecLocalStorage" #saveNostrSecretEncrypted
      tabindex="12" class="nostrCheck" id="saveNostrSecretEncrypted" type="checkbox" />
    <label for="saveNostrSecretEncrypted">Save nostr secret (nsec) encrypted in this browser?</label>
  </div>

  <div *ngIf="saveNostrSecretEncrypted.checked" [class.error]="submitted && getFormControlErrors('password')"
    class="floatingLabel passwordField">

    <input #password required name="password" tabindex="13" [maxlength]="passwordLength" formControlName="password"
      id="addAccountPasswordField" [class.hasValue]="password.value" [attr.readonly]="loading ? 'readonly' : null"
      [attr.type]="showPassword ? 'text' : 'password'" />

    <label for="addAccountPasswordField">Password</label>

    <button type="button" tabindex="19" [attr.title]="showPassword ? 'hide password' : 'show password'"
      (click)="showPassword = !showPassword" class="bordered svgButton">

      <nostr-svg-render [name]="showPassword ? 'eyeOff' : 'eye'"></nostr-svg-render>
    </button>

    <ng-container *ngIf="submitted">
      <span *ngIf="getFormControlErrorStatus('password', 'required')" class="error">
        Include a password to improve your privacity
      </span>
    </ng-container>
  </div>

  <div class="nostrCheckWrapper">
    <input class="nostrCheck" tabindex="14" id="saveNostrSecretInSession" type="checkbox" />
    <label for="saveNostrSecretInSession">Save nostr secret (nsec) in this session</label>
  </div>

  <div class="button-group">
    <button type="submit" tabindex="15" title="login" class="button secondary iconedButton">
      <nostr-svg-render *ngIf="!loading" class="inlineIcon" name="plus"></nostr-svg-render>
      <nostr-loading *ngIf="loading"></nostr-loading>

      <span>
        Login
      </span>
    </button>

    <button *ngIf="accounts.length" type="button" tabindex="16" title="back" (click)="changeStep.next('select-account')"
      class="button secondary iconedButton">
      <nostr-svg-render class="inlineIcon" name="left"></nostr-svg-render>

      <span>
        Back
      </span>
    </button>
  </div>
</form>